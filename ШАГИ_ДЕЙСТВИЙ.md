# ‚úÖ –ù–∞—à–∏ —à–∞–≥–∏: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

**–ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É**

---

## üéØ –¶–ï–õ–¨
–ó–∞—â–∏—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∫ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –±—ã—Å—Ç—Ä–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ.

---

## üìã –®–ê–ì–ò (–≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É)

### ‚úÖ –®–ê–ì 1: –£–∑–Ω–∞—Ç—å —Å–≤–æ–π IP –∞–¥—Ä–µ—Å
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞: https://ifconfig.me
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ü–∏—Ñ—Ä—ã (—ç—Ç–æ –≤–∞—à IP, –Ω–∞–ø—Ä–∏–º–µ—Ä: `123.45.67.89`)
4. –ó–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ - –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ

**–í—Ä–µ–º—è:** 1 –º–∏–Ω—É—Ç–∞

---

### ‚úÖ –®–ê–ì 2: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –¢–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ Mac (Cmd+Space, –≤–≤–µ–¥–∏—Ç–µ "–¢–µ—Ä–º–∏–Ω–∞–ª")
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:
   ```bash
   ssh root@37.1.212.51
   ```
3. –ù–∞–∂–º–∏—Ç–µ Enter
4. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: `LEJ6U5chSK` (–ø–∞—Ä–æ–ª—å –Ω–µ –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
5. –ù–∞–∂–º–∏—Ç–µ Enter

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–æ–∫—É —Ç–∏–ø–∞ `root@...` - —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, –≤—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

**–í—Ä–µ–º—è:** 1 –º–∏–Ω—É—Ç–∞

---

### ‚úÖ –®–ê–ì 3: –ó–∞–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–∫—Å–∏ –¥–ª—è –≤—Å–µ—Ö, –∫—Ä–æ–º–µ –≤–∞—Å
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –í—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ä–≤–µ—Ä—É (–µ—Å–ª–∏ –Ω–µ—Ç - –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –®–ê–ì 2)
2. –ó–∞–º–µ–Ω–∏—Ç–µ `–í–ê–®_IP` –Ω–∞ IP –∏–∑ –®–ê–ì–ê 1 (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ IP –±—ã–ª `123.45.67.89`, —Ç–æ –∫–æ–º–∞–Ω–¥–∞ –±—É–¥–µ—Ç: `ufw allow from 123.45.67.89...`)
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ (–∫–∞–∂–¥—É—é –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ, –Ω–∞–∂–∏–º–∞—è Enter):

```bash
ufw allow from –í–ê–®_IP to any port 8080 proto tcp comment "TinyProxy access"
```

```bash
ufw deny 8080/tcp
```

```bash
ufw reload
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –Ω–∞ –ø–æ—Ä—Ç—É 8080.

**–í—Ä–µ–º—è:** 2 –º–∏–Ω—É—Ç—ã

---

### ‚úÖ –®–ê–ì 4: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–º–∞–∫—Å–∏–º—É–º 20)
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –í—ã –≤—Å–µ –µ—â–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ä–≤–µ—Ä—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
   ```bash
   nano /etc/tinyproxy/tinyproxy.conf
   ```
3. –ù–∞–∂–º–∏—Ç–µ Enter
4. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `#MaxClients 100` (–∏–ª–∏ –ø–æ—Ö–æ–∂—É—é, –º–æ–∂–µ—Ç –±—ã—Ç—å –±–µ–∑ `#`)
5. –ù–∞–∂–º–∏—Ç–µ —Å—Ç—Ä–µ–ª–∫—É –≤–Ω–∏–∑, —á—Ç–æ–±—ã –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –∫ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ
6. –£–¥–∞–ª–∏—Ç–µ —Å–∏–º–≤–æ–ª `#` –≤ –Ω–∞—á–∞–ª–µ (–µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å)
7. –ò–∑–º–µ–Ω–∏—Ç–µ —á–∏—Å–ª–æ –Ω–∞ `20`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–æ—Å—å: `MaxClients 20`
8. –ù–∞–∂–º–∏—Ç–µ `Ctrl + O` (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å), –∑–∞—Ç–µ–º Enter
9. –ù–∞–∂–º–∏—Ç–µ `Ctrl + X` (–≤—ã–π—Ç–∏)
10. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏:
    ```bash
    systemctl restart tinyproxy
    ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–∫—Å–∏ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±–æ–ª—å—à–µ 20 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–í—Ä–µ–º—è:** 3 –º–∏–Ω—É—Ç—ã

---

### ‚úÖ –®–ê–ì 5: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –∞—Ç–∞–∫ (fail2ban)
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –í—ã –≤—Å–µ –µ—â–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ä–≤–µ—Ä—É
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏:

```bash
apt-get update
```
(–ù–∞–∂–º–∏—Ç–µ Enter, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)

```bash
apt-get install fail2ban -y
```
(–ù–∞–∂–º–∏—Ç–µ Enter, –ø–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–ø—Ä–æ—Å–∏—Ç - –≤–≤–µ–¥–∏—Ç–µ `Y`)

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
```bash
cat > /etc/fail2ban/jail.d/tinyproxy.conf << 'EOF'
[tinyproxy]
enabled = true
port = 8080
filter = tinyproxy
logpath = /var/log/tinyproxy/tinyproxy.log
maxretry = 3
bantime = 3600
findtime = 600
EOF
```

4. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä:
```bash
cat > /etc/fail2ban/filter.d/tinyproxy.conf << 'EOF'
[Definition]
failregex = ^.*\[WARNING\].*Connection from <HOST> refused.*$
            ^.*\[ERROR\].*Connection from <HOST> failed.*$
ignoreregex =
EOF
```

5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞—â–∏—Ç—É:
```bash
systemctl restart fail2ban
```

```bash
systemctl enable fail2ban
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è.

**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

### ‚úÖ –®–ê–ì 6: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–º–∞–∫—Å–∏–º—É–º 512 –ú–ë)
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –í—ã –≤—Å–µ –µ—â–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ä–≤–µ—Ä—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª—É–∂–±—ã:
   ```bash
   systemctl edit tinyproxy
   ```
3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä. –í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏:
   ```
   [Service]
   MemoryLimit=512M
   CPUQuota=50%
   TasksMax=50
   ```
4. –ù–∞–∂–º–∏—Ç–µ `Ctrl + O` (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å), –∑–∞—Ç–µ–º Enter
5. –ù–∞–∂–º–∏—Ç–µ `Ctrl + X` (–≤—ã–π—Ç–∏)
6. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```bash
   systemctl daemon-reload
   ```
   ```bash
   systemctl restart tinyproxy
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–∫—Å–∏ –Ω–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ 512 –ú–ë –ø–∞–º—è—Ç–∏.

**–í—Ä–µ–º—è:** 3 –º–∏–Ω—É—Ç—ã

---

### ‚úÖ –®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –í—ã –≤—Å–µ –µ—â–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ä–≤–µ—Ä—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ 20):
   ```bash
   ss -tn | grep :8080 | wc -l
   ```
   - –ï—Å–ª–∏ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ 20 - –æ—Ç–ª–∏—á–Ω–æ! ‚úÖ
   - –ï—Å–ª–∏ –±–æ–ª—å—à–µ - –ø–æ–¥–æ–∂–¥–∏—Ç–µ 5 –º–∏–Ω—É—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–Ω–æ–≤–∞

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:
   ```bash
   free -h
   ```
   - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É "Mem:" - –µ—Å–ª–∏ "used" –º–µ–Ω—å—à–µ 80% - –æ—Ç–ª–∏—á–Ω–æ! ‚úÖ

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã:
   ```bash
   fail2ban-client status tinyproxy
   ```
   - –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ "Status: Active" - –æ—Ç–ª–∏—á–Ω–æ! ‚úÖ

5. –í—ã–π–¥–∏—Ç–µ —Å —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   exit
   ```

**–í—Ä–µ–º—è:** 2 –º–∏–Ω—É—Ç—ã

---

## ‚è±Ô∏è –ò–¢–û–ì–û

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 30-60 –º–∏–Ω—É—Ç  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ—Å—Ç–∞—è (–Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã)

---

## ‚úÖ –ß–¢–û –ü–û–õ–£–ß–ò–ú –ü–û–°–õ–ï –í–°–ï–• –®–ê–ì–û–í

- ‚úÖ –¢–æ–ª—å–∫–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ (–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã)
- ‚úÖ –ü—Ä–æ–∫—Å–∏ –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω (–º–∞–∫—Å–∏–º—É–º 20 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π)
- ‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ü—Ä–æ–∫—Å–∏ –Ω–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏
- ‚úÖ –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ VPN –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ (–Ω–µ —Ç—Ä–æ–≥–∞–ª–∏)

---

## üìù –ß–ï–ö–õ–ò–°–¢

- [ ] –®–ê–ì 1: –£–∑–Ω–∞–ª —Å–≤–æ–π IP
- [ ] –®–ê–ì 2: –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] –®–ê–ì 3: –ó–∞–∫—Ä—ã–ª –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–∫—Å–∏
- [ ] –®–ê–ì 4: –û–≥—Ä–∞–Ω–∏—á–∏–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ 20
- [ ] –®–ê–ì 5: –£—Å—Ç–∞–Ω–æ–≤–∏–ª fail2ban
- [ ] –®–ê–ì 6: –û–≥—Ä–∞–Ω–∏—á–∏–ª –ø–∞–º—è—Ç—å
- [ ] –®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä–∏–ª, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û –ü–û–ú–ù–ò–¢–¨

1. **–ï—Å–ª–∏ –≤–∞—à IP –º–µ–Ω—è–µ—Ç—Å—è** (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π IP –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞), –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –®–ê–ì 3 —Å –Ω–æ–≤—ã–º IP

2. **–ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏** —Å–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π):
   ```bash
   cp /etc/tinyproxy/tinyproxy.conf /etc/tinyproxy/tinyproxy.conf.backup
   ```

3. **VPN –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤** (–ø–æ—Ä—Ç 443) –Ω–µ —Ç—Ä–æ–≥–∞–µ–º - –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## üÜò –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –ü–û–õ–£–ß–ê–ï–¢–°–Ø

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∑–∞ –ø–æ–º–æ—â—å—é, –ø–æ–∫–∞–∑–∞–≤ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç

---

**–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?** –ù–∞—á–Ω–∏—Ç–µ —Å –®–ê–ì–ê 1! üöÄ
