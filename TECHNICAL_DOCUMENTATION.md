# üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è VPN-—Å–µ—Ä–≤–µ—Ä–∞

## üìå –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ VPN-—Å–µ—Ä–≤–µ—Ä–∞ —Å –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å–æ–º –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ò–ò-—Å–µ—Ä–≤–∏—Å–∞–º–∏ (OpenAI API).

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
*   **–ü—Ä–æ—Ç–æ–∫–æ–ª VLESS + REALITY:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫—É –ø–æ–¥ –æ–±—ã—á–Ω—ã–π TLS-—Ç—Ä–∞—Ñ–∏–∫ (Microsoft).
*   **–ü–∞–Ω–µ–ª—å Marzban:** –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏.
*   **TinyProxy:** –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, MarketingBot).
*   **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏ (VPN, Proxy, Amnezia).

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TD
    User([–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]) -- "VLESS + REALITY (Port 443)" --> Server[VPS Server 37.1.212.51]
    
    subgraph "Docker Environment"
        Marzban[Marzban Panel] -- "–£–ø—Ä–∞–≤–ª—è–µ—Ç" --> Xray[Xray Core]
        Xray -- "VLESS + Reality" --> Port443[Port 443]
    end
    
    subgraph "System Services"
        TinyProxy[TinyProxy Port 8080]
        Amnezia[Amnezia WG/AWG]
    end
    
    MarketingBot[MarketingBot] -- "HTTP Proxy" --> TinyProxy
    TinyProxy -- "–ó–∞–ø—Ä–æ—Å—ã" --> OpenAI[OpenAI API]
    
    Marzban -- "Web UI (localhost:8000)" --> SSH[SSH Tunnel]
    SSH -- "–î–æ—Å—Ç—É–ø" --> Admin([–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä])
```

---

## üñ•Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ –∏ —Å–µ—Ä–≤–µ—Ä

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞:
*   **–û–°:** Ubuntu 22.04.4 LTS
*   **IP:** 37.1.212.51
*   **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –°–®–ê (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –≤ –†–§)

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û:
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Ä—Å–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **Docker** | 29.1.4 | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è Marzban –∏ Amnezia |
| **Xray Core** | 24.12.31 | –Ø–¥—Ä–æ VPN-—Å–µ—Ä–≤–∏—Å–∞ (VLESS, Shadowsocks) |
| **Marzban** | latest | –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ |
| **TinyProxy** | Systemd service | HTTP-–ø—Ä–æ–∫—Å–∏ –¥–ª—è –±–æ—Ç–∞ |

---

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPN (VLESS + REALITY)

–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–æ—Å—Ç—É–ø–∞, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –æ–±—Ö–æ–¥ DPI –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫—É —Ç—Ä–∞—Ñ–∏–∫–∞.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞:
*   **–ü–æ—Ä—Ç:** `443`
*   **–¢–∏–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** `REALITY`
*   **–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ (SNI):** `www.microsoft.com`
*   **Flow:** `xtls-rprx-vision` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)
*   **–ö–ª—é—á–∏ REALITY:**
    *   **Public Key:** `n5E8KcFHjef-ZC2mKjzkVldLJiLrsjfpE1Z-XmLfxH4`
    *   **Private Key:** –ó–∞—â–∏—â–µ–Ω (—Å–º. `ALL_CREDENTIALS.md`)

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
*   **UUID:** `eb4a1cf2-4235-4b0a-83b2-0e5a298389ed`
*   **–°—Å—ã–ª–∫–∞:** `vless://{uuid}@{ip}:443?type=tcp&security=reality&sni=www.microsoft.com&fp=chrome&flow=xtls-rprx-vision#VLESS-Reality`

---

## üîå –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å (TinyProxy)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ OpenAI API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–æ–¥—É–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, MarketingBot).

*   **–ü–æ—Ä—Ç:** `8080`
*   **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** root:`LEJ6U5chSK`
*   **–¢–∏–ø:** HTTP/HTTPS
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ .env:**
    ```bash
    HTTP_PROXY=http://root:LEJ6U5chSK@37.1.212.51:8080
    HTTPS_PROXY=http://root:LEJ6U5chSK@37.1.212.51:8080
    ```

---

## üì¶ –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –º–æ–¥—É–ª–∏ –º–æ–≥–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Marzban (VPN):
```bash
cd /opt/marzban
docker compose up -d      # –ó–∞–ø—É—Å–∫
docker compose restart    # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose down       # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TinyProxy:
```bash
sudo systemctl status tinyproxy
sudo systemctl restart tinyproxy
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –§–∞–π—Ä–≤–æ–ª–æ–º (UFW):
–ü–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è/–∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ:
```bash
sudo ufw allow 443/tcp    # –û—Ç–∫—Ä—ã—Ç—å VPN
sudo ufw allow 8080/tcp   # –û—Ç–∫—Ä—ã—Ç—å Proxy
```

---

## üì± –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω–µ—á–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1.  **Amnezia VPN** (Windows, macOS, iOS, Android) ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç —Å—Å—ã–ª–∫–∏.
2.  **v2rayNG** (Android) / **Shadowrocket** (iOS).
3.  **V2RayN** (Windows).

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –±—ç–∫–∞–ø—ã

### –ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã:
*   **REALITY:** –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–µ—Ä–≤–µ—Ä –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç—Å—è Microsoft).
*   **UFW:** –§–∞–π—Ä–≤–æ–ª —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã (22, 443, 8080, 8000).
*   **SSH Tunnel:** –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Marzban –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SSH-—Ç—É–Ω–Ω–µ–ª—å (localhost:8000).

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ç–∫–∞–ø–∞:
1.  `/var/lib/marzban/db.sqlite3` ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
2.  `/var/lib/marzban/xray_config.json` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray.
3.  `/opt/marzban/.env` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–Ω–µ–ª–∏.

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

| –ü—Ä–æ–±–ª–µ–º–∞ | –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ | –†–µ—à–µ–Ω–∏–µ |
| :--- | :--- | :--- |
| –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPN | `netstat -tlnp \| grep 443` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Marzban |
| –ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç OpenAI | `curl -x ... https://api.openai.com` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å TinyProxy |
| –ü–∞–Ω–µ–ª—å –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è | `docker ps \| grep marzban` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ —Ç—É–Ω–Ω–µ–ª—è |

---
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞:** 21 —è–Ω–≤–∞—Ä—è 2026
