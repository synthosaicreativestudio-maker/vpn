#!/bin/bash

# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð² ÑÐµÑ€Ð²ÐµÑ€Ð°
# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ñ‡ÐµÑ€ÐµÐ· Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð» Ð² Ð¿Ð°Ð½ÐµÐ»Ð¸ is*hosting Ð¸Ð»Ð¸ Ñ‡ÐµÑ€ÐµÐ· SSH

echo "=========================================="
echo "ðŸ“Š Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• Ð Ð•Ð¡Ð£Ð Ð¡ÐžÐ’ Ð¡Ð•Ð Ð’Ð•Ð Ð"
echo "=========================================="
echo ""

# 1. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð¸ÑÐºÐ°
echo "ðŸ’¾ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• Ð”Ð˜Ð¡ÐšÐ:"
echo "----------------------------------------"
df -h / | awk 'NR==1 || /\/$/'
echo ""

# 2. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ RAM
echo "ðŸ§  Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• ÐžÐ—Ð£ (RAM):"
echo "----------------------------------------"
free -h
echo ""

# 3. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ CPU
echo "âš™ï¸  Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• CPU:"
echo "----------------------------------------"
echo "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° CPU Ð·Ð° 1, 5, 15 Ð¼Ð¸Ð½ÑƒÑ‚:"
uptime | awk -F'load average:' '{print $2}'
echo ""
echo "Ð¢Ð¾Ð¿ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ CPU:"
ps aux --sort=-%cpu | head -6 | awk '{printf "%-8s %6s%% %s\n", $1, $3, $11}'
echo ""

# 4. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° (ÐµÑÐ»Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ vnstat)
echo "ðŸŒ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• Ð¢Ð ÐÐ¤Ð˜ÐšÐ:"
echo "----------------------------------------"
if command -v vnstat &> /dev/null; then
    vnstat -d
    echo ""
    vnstat -m
else
    echo "âš ï¸  vnstat Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ: apt install vnstat"
    echo "Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‚Ñ€Ð°Ñ„Ð¸Ðº Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð² Ð¿Ð°Ð½ÐµÐ»Ð¸ is*hosting"
fi
echo ""

# 5. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Docker
echo "ðŸ³ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐÐ˜Ð• DOCKER:"
echo "----------------------------------------"
if command -v docker &> /dev/null; then
    docker system df 2>/dev/null || echo "Docker Ð½Ðµ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¸Ð»Ð¸ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð²"
else
    echo "Docker Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½"
fi
echo ""

# 6. Ð Ð°Ð·Ð¼ÐµÑ€ Ð»Ð¾Ð³Ð¾Ð²
echo "ðŸ“ Ð ÐÐ—ÐœÐ•Ð  Ð›ÐžÐ“ÐžÐ’:"
echo "----------------------------------------"
du -sh /var/log/* 2>/dev/null | sort -hr | head -5
echo ""

# 7. Ð Ð°Ð·Ð¼ÐµÑ€ Docker Ð´Ð°Ð½Ð½Ñ‹Ñ…
echo "ðŸ³ Ð ÐÐ—ÐœÐ•Ð  DOCKER Ð”ÐÐÐÐ«Ð¥:"
echo "----------------------------------------"
if [ -d /var/lib/docker ]; then
    du -sh /var/lib/docker 2>/dev/null
fi
if [ -d /var/lib/marzban ]; then
    echo "Marzban Ð´Ð°Ð½Ð½Ñ‹Ðµ:"
    du -sh /var/lib/marzban 2>/dev/null
fi
echo ""

echo "=========================================="
echo "âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°"
echo "=========================================="
