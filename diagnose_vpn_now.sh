#!/bin/bash

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ VPN - –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–∞–Ω–µ–ª–∏ is*hosting

echo "=========================================="
echo "üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê VPN"
echo "=========================================="
echo ""

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo "1Ô∏è‚É£  Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:"
echo "----------------------------------------"
docker ps -a | grep marzban || echo "‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä Marzban –Ω–µ –Ω–∞–π–¥–µ–Ω"
echo ""

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 443
echo "2Ô∏è‚É£  –ü–æ—Ä—Ç 443:"
echo "----------------------------------------"
netstat -tlnp | grep 443 || ss -tlnp | grep 443 || echo "‚ùå –ü–æ—Ä—Ç 443 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"
echo ""

# 3. –°—Ç–∞—Ç—É—Å Docker
echo "3Ô∏è‚É£  –°—Ç–∞—Ç—É—Å Docker:"
echo "----------------------------------------"
systemctl is-active docker && echo "‚úÖ Docker –∞–∫—Ç–∏–≤–µ–Ω" || echo "‚ùå Docker –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω"
echo ""

# 4. –õ–æ–≥–∏ Marzban (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫)
echo "4Ô∏è‚É£  –õ–æ–≥–∏ Marzban:"
echo "----------------------------------------"
docker logs marzban-marzban-1 --tail 30 2>&1 | head -40 || echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏"
echo ""

# 5. –§–∞–π—Ä–≤–æ–ª
echo "5Ô∏è‚É£  –§–∞–π—Ä–≤–æ–ª (UFW):"
echo "----------------------------------------"
ufw status | grep -E "443|Status" || echo "‚ö†Ô∏è  UFW –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω"
echo ""

# 6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray
echo "6Ô∏è‚É£  –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è VLESS Reality:"
echo "----------------------------------------"
if [ -f /var/lib/marzban/xray_config.json ]; then
    if grep -q "VLESS-Reality" /var/lib/marzban/xray_config.json 2>/dev/null; then
        echo "‚úÖ VLESS Reality –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞"
    else
        echo "‚ùå VLESS Reality –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ù–ï –Ω–∞–π–¥–µ–Ω–∞"
    fi
else
    echo "‚ùå –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
fi
echo ""

# 7. –ü—Ä–æ—Ü–µ—Å—Å xray
echo "7Ô∏è‚É£  –ü—Ä–æ—Ü–µ—Å—Å Xray:"
echo "----------------------------------------"
ps aux | grep xray | grep -v grep || echo "‚ùå –ü—Ä–æ—Ü–µ—Å—Å Xray –Ω–µ –∑–∞–ø—É—â–µ–Ω"
echo ""

echo "=========================================="
echo "‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
echo "=========================================="
echo ""
echo "üìã –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"
