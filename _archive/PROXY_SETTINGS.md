# üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è OpenAI API

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ OpenAI API. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ OpenAI API –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –≤ –°–®–ê, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –∏–∑ —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏.

## üåê –î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **–•–æ—Å—Ç:** `37.1.212.51`
- **–ü–æ—Ä—Ç:** `8080`
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** HTTP
- **–õ–æ–≥–∏–Ω:** `root`
- **–ü–∞—Ä–æ–ª—å:** `LEJ6U5chSK`

### –ü–æ–ª–Ω—ã–π URL –ø—Ä–æ–∫—Å–∏:

```
http://root:LEJ6U5chSK@37.1.212.51:8080
```

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è `.env` —Ñ–∞–π–ª–∞:

```bash
# OpenAI Proxy Configuration
OPENAI_PROXY_URL=http://root:LEJ6U5chSK@37.1.212.51:8080
HTTP_PROXY=http://37.1.212.51:8080
HTTPS_PROXY=http://37.1.212.51:8080
NO_PROXY=127.0.0.1,localhost,10.129.0.24
```

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

- **`OPENAI_PROXY_URL`** - –ü–æ–ª–Ω—ã–π URL –ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ OpenAI –∫–ª–∏–µ–Ω—Ç–µ
- **`HTTP_PROXY`** - –ü—Ä–æ–∫—Å–∏ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã)
- **`HTTPS_PROXY`** - –ü—Ä–æ–∫—Å–∏ –¥–ª—è HTTPS –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã)
- **`NO_PROXY`** - –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –æ–±—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–∫—Å–∏ (–ª–æ–∫–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞)

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ `.env` —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```bash
# OpenAI Proxy Configuration
OPENAI_PROXY_URL=http://root:LEJ6U5chSK@37.1.212.51:8080
HTTP_PROXY=http://37.1.212.51:8080
HTTPS_PROXY=http://37.1.212.51:8080
NO_PROXY=127.0.0.1,localhost,10.129.0.24
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo systemctl restart marketingbot-bot.service

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
python3 bot.py
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∫—Å–∏

–í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
Using proxy for OpenAI API: 37.1.212.51:8080
```

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –§–∞–π–ª: `openai_service.py`

–ü—Ä–æ–∫—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–ª–∞—Å—Å–µ `OpenAIService` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTP –∫–ª–∏–µ–Ω—Ç–∞:

```python
def __init__(self) -> None:
    api_key = os.getenv("OPENAI_API_KEY")
    assistant_id = os.getenv("OPENAI_ASSISTANT_ID")
    proxy_url = os.getenv("OPENAI_PROXY_URL")

    if not api_key or not assistant_id:
        logger.warning(
            "OpenAIService disabled: missing OPENAI_API_KEY or OPENAI_ASSISTANT_ID"
        )
        self.client = None
        self.assistant_id = None
    else:
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTP –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø—Ä–æ–∫—Å–∏, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
        http_client = None
        if proxy_url:
            logger.info(f"Using proxy for OpenAI API: {proxy_url.split('@')[1] if '@' in proxy_url else proxy_url}")
            http_client = httpx.Client(
                proxy=proxy_url,
                timeout=60.0
            )
        else:
            http_client = httpx.Client(timeout=60.0)
        
        self.client = OpenAI(api_key=api_key, http_client=http_client)
        self.assistant_id = assistant_id
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `OpenAIService` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `OPENAI_PROXY_URL`
2. –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ —É–∫–∞–∑–∞–Ω, —Å–æ–∑–¥–∞–µ—Ç—Å—è `httpx.Client` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø—Ä–æ–∫—Å–∏
3. –≠—Ç–æ—Ç –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `OpenAI`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
4. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ OpenAI API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### NO_PROXY

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NO_PROXY` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –æ–±—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–∫—Å–∏:

- `127.0.0.1` - –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
- `localhost` - –ª–æ–∫–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç
- `10.129.0.24` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞

–≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —à–ª–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é.

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å)
   - –§–∞–π–ª `.env` –ù–ï –¥–æ–ª–∂–µ–Ω –∫–æ–º–º–∏—Ç–∏—Ç—å—Å—è –≤ Git (—É–∂–µ –≤ `.gitignore`)
   - –•—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏ –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
   - –¢–∞–π–º–∞—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 60 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–µ–∫

3. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:**
   - –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—Ä–æ—Å—ã –∫ OpenAI API –±—É–¥—É—Ç –ø–∞–¥–∞—Ç—å
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞

4. **–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
   - –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–∞ –∫ OpenAI API
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–≥–∏–æ–Ω–µ, –≥–¥–µ OpenAI API –¥–æ—Å—Ç—É–ø–µ–Ω

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ–∫—Å–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è "Using proxy for OpenAI API"
- –ó–∞–ø—Ä–æ—Å—ã –∫ OpenAI API –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `OPENAI_PROXY_URL` –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `http://user:pass@host:port`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ó–∞–ø—Ä–æ—Å—ã –∫ OpenAI API –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π —Ç–∞–π–º–∞—É—Ç–∞
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç API

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞: `curl -x http://root:LEJ6U5chSK@37.1.212.51:8080 https://api.openai.com/v1/models`
2. –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç –≤ –∫–æ–¥–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60 —Å–µ–∫—É–Ω–¥)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏ 407 (Proxy Authentication Required)
- –û—à–∏–±–∫–∏ 403 (Forbidden)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –≤ `OPENAI_PROXY_URL`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç URL —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é: `http://user:pass@host:port`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≤–∞—à–µ–≥–æ IP

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **2026-01-12** - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø—Ä–æ–∫—Å–∏
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä `37.1.212.51:8080` –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π OpenAI API

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `openai_service.py` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∫—Å–∏ –≤ –∫–æ–¥–µ
- `.env` - –§–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ Git)
- `docs/DEPLOYMENT.md` - –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

---

**–í–∞–∂–Ω–æ:** –î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ —è–≤–ª—è—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏. –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
